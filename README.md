# Grant-Agent

研究者向け助成金検索支援AIエージェント

## プロジェクト概要

このプロジェクトは、研究者が適切な研究助成金を見つけるのを支援するAIエージェントを提供します。研究者のプロファイルを基に、Google ADK（Agent Development Kit）を利用して複数のエージェントが協力して助成金機会を検索・評価します。

### 主な機能

- 研究者プロファイルの分析
- 研究分野に適した助成金カテゴリの特定
- API不要の検索エンジンを使用したWeb検索（DuckDuckGoとSearx）
- PDF文書からの情報抽出
- 助成金情報の構造化と評価
- 最適な助成金機会の特定と詳細調査

## インストール方法

### 方法1: Docker版（推奨）

#### システム要件
- Docker
- Docker Compose（macOS/Windowsの場合はDocker Desktopに含まれています）
  > **注意**: 現在のバージョンでは `docker compose`（スペース区切り）構文を使用しています。古い `docker-compose`（ハイフン付き）コマンドは使用していません。
- インターネット接続

#### インストール手順
1. このリポジトリのリリースページから `v0.4.0-preview` をダウンロードするか、以下のコマンドでリポジトリをクローンして取得します：
   - [**ダウンロードリンク**](https://github.com/HirotoYoshimura/grant-agent/releases/download/v0.4.0-preview/grantsearch-docker.zip)
   ```bash
   git clone https://github.com/yourusername/grant-agent.git
   cd grant-agent
   ```
2. zipファイルを任意のディレクトリに展開
3. ターミナルで展開したディレクトリに移動
4. 以下のコマンドを実行：
   ```bash
   ./start-grantsearch.sh
   ```
5. 詳細な使用方法は[grantsearch-docker/README.md](grantsearch-docker/README.md)を参照

### 方法2: 開発環境での実行（開発者向け）

#### システム要件
- Docker & Docker Compose
- Visual Studio Code + Dev Containers拡張機能
- インターネット接続

#### インストール手順

##### 1. リポジトリのクローン

```bash
git clone https://github.com/yourusername/grant-agent.git
cd grant-agent
```

##### 2. Visual Studio Codeで開く

Visual Studio Codeでプロジェクトフォルダを開きます。

##### 3. Dev Containerで開く

1. VSCodeの左下隅にある「><」アイコンをクリックします
2. 「コンテナーで再度開く」または「Reopen in Container」を選択します
3. VSCode が Dev Container を構築し、リポジトリをコンテナ内で開きます。これには数分かかる場合があります
4. 一度コンテナが作成されれば、以降はサイドバーの Remote Explorer、上部タブの Dev Containers から grant-agent を選んでクリックすることで構築済みの環境に入ることができます

##### 4. 必要なAPIキーの取得方法

###### Google Gemini API Key の取得

1. **Google AI Studio にアクセス**
   - [Google AI Studio](https://makersuite.google.com/app/apikey) にアクセスします
   - Googleアカウントでログインします

2. **API キーの作成**
   - 「API キーを取得」または「Create API Key」をクリックします
   - 新しいAPIキーが生成されます。このキーをコピーして安全な場所に保存してください（これが Gemini API Key になります）

##### 5. アプリケーションの環境設定

1. Dev Container 内で、ターミナルを開きます（VSCode のメニューから「ターミナル」→「新しいターミナル」）
2. 以下のコマンドを実行して、環境セットアップスクリプトを実行します:
   ```bash
   cd google-adk
   ./setup_env.sh
   ```
3. このスクリプトは必要な Python パッケージをインストールし、仮想環境を設定します

##### 6. アプリケーションの起動

1. Dev Container 内のターミナルで、以下のコマンドを実行してアプリケーションを起動します:
   ```bash
   ./run_ui.sh
   ```
2. ブラウザで Streamlit アプリが自動的に開きます（通常は http://localhost:8501）

## アプリケーションの使用方法

以下の使用方法は、Docker版と開発環境版の両方に共通です。

### 1. API設定

1. サイドバーの「API設定」をクリックします
2. Google AI Studioから取得したGemini APIキーを入力します
3. 「設定を保存」ボタンをクリックします

### 2. LLM モデル設定

1. サイドバーの「LLMモデル設定」をクリックします
2. 各エージェントに使用する Gemini モデルを選択します:
   - profile_analyzer: プロファイル分析を行うエージェント
   - hypotheses_generator: 仮説を生成するエージェント
   - query_generator: 検索クエリを生成するエージェント
   - search_expert: 検索と情報抽出を行うエージェント
   - report_generator: レポートを生成するエージェント
   - user_proxy: ユーザー代理として働くエージェント
   - investigation_evaluator: 調査情報を評価するエージェント
3. 「設定を保存」ボタンをクリックします


### 3. プロファイル登録

1. サイドバーの「ユーザープロファイル」をクリックします
2. 以下のいずれかの方法でプロファイルを設定します:
   - テキストエリアに直接入力する
   - 既存のテキストファイルをアップロードする
   - PDF書類をアップロードし、AIがプロファイル情報を抽出する
3. 「保存」ボタンをクリックします

### 4. 助成金検索の実行

1. サイドバーの「検索実行」をクリックします
2. 以下のパラメータを設定します:
   - ユーザープロファイル: 使用するプロファイルファイルを選択します
   - 検索結果出力先: 結果を保存するディレクトリを指定します
   - 調査する助成金数: 詳細調査を行う助成金の数を設定します
   - 最小候補数: 収集する助成金候補の最小数を設定します
3. 「検索開始」ボタンをクリックします
4. ログ出力を確認しながら、進行状況を追跡します

### 5. 結果の確認

1. サイドバーの「検索結果」をクリックします
2. 「候補」タブで収集された全ての助成金候補を確認できます
3. 「調査済み」タブで、詳細調査が完了した助成金の情報を確認できます
4. 必要に応じて CSV ファイルをダウンロードできます
5. 実行ログを確認し、必要に応じてダウンロードすることもできます

## トラブルシューティング

### API キーに関する問題

- **Gemini API キーエラー**: API設定ページで正しいGemini APIキーを入力しているか確認してください
- **検索結果が表示されない**: 現在はAPI不要の検索ツールを使用しているため、接続の問題やネットワーク制限を確認してください

### 実行エラー

- **プロファイル読み込みエラー**: プロファイルテキストが正しく入力されているか確認してください。
- **モジュールインポートエラー**: setup_env.sh スクリプトを再実行して、すべての依存関係が正しくインストールされていることを確認してください。
- **ディレクトリやファイルが見つからない**: アプリケーションのルートディレクトリから実行していることを確認してください。
- **エージェントが正しく動作しない**: 無料枠のAPIだと同じモデルでも動作が不安定になる場合があります。何度か実行するか、従量課金プランを検討してください。
- **429エラー**:　APIキーのレート制限に達しています。より小型のモデルを使用するか、従量課金プランを検討してください（1回の実行であれば数十円程度です）。
- **503エラー**: 無料枠だと使用頻度が高い場合にオーバーロードエラーが起きることがあります。数分時間をおいて、再度実行してみたください。

### Streamlit UI の問題

- **ページが読み込まれない**: ブラウザのキャッシュをクリアし、ページを再読み込みしてください。
- **UIが応答しない**: アプリケーションを再起動してください。
- **ファイルアップロードの問題**: ファイルサイズが大きすぎないか確認してください。

## ライセンス

MIT
